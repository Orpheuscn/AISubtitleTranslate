# 测试用例

## 测试用例 1：两条字幕合并问题（829-830）

**输入：**
```
[829] speaks of that suffering woman who can find no rest
[830] and who tosses in her bed due to the pain that torments her,
```

**期望输出（2 个序号）：**
```
[829] 说起那个无法安眠、
[830] 痛苦辗转的女人时，
```

**常见错误（合并成 1 个序号）：**
```
[829] 说起那个无法安眠、痛苦辗转的女人时，
```

---

## 测试用例 2：三条地名列表（763-765）

**输入：**
```
[763] The total value of his homes and villas,
[764] in Florence, in Careggi, in Cafaggiolo,
[765] in Trebbio, in Pisa and in Milan:
```

**期望输出（3 个序号）：**
```
[763] 他的住宅与别墅的总价值，
[764] 位于佛罗伦萨、卡雷吉、卡法焦洛、
[765] 特雷比奥、比萨和米兰：
```

**常见错误（合并成 2 个序号）：**
```
[763] 他在佛罗伦萨、卡雷吉、卡法焦洛、
[764] 特雷比奥、比萨和米兰的住宅与别墅总价值：
```

---

## 测试用例 3：带上下文的延续（96-99）

**输入：**
```
[96] [CONTEXT] I want to tell you that I believe I have lived out the time
[97] [CONTEXT] assigned to me by God on the day of my birth.
[98] And I wish to tell you that I die happy
[99] because I leave you rich and healthy,
```

**期望输出（2 个序号，不包括 CONTEXT）：**
```
[98] 并且我想告诉你们，我死而无憾，
[99] 因为我留给你们财富、健康，
```

**注意事项：**
- [96] 和 [97] 是上下文，不需要翻译
- [98] 是 [96] 的延续，应该用"并且"等连接词
- [99] 是 [98] 的原因从句，应该用"因为"

---

## 测试用例 4：单条字幕（不应该被拆分）

**输入：**
```
[100] Nothing gives me more serenity
```

**期望输出（1 个序号）：**
```
[100] 没有什么比这更让我感到平静
```

**常见错误（错误拆分成多个序号）：**
```
[100] 没有什么
[101] 比这更让我感到平静
```

---

## 如何测试

1. 在应用中加载包含这些序号的字幕文件
2. 选择包含测试用例的批次进行翻译
3. 观察控制台输出：
   - 查看"期望数量"和"实际获得"是否一致
   - 如果不一致，查看"缺失的序号"和"多余的序号"
   - 查看完整的 API 响应内容
4. 检查翻译结果是否符合期望

## 成功标准

- ✅ 序号数量完全匹配
- ✅ 序号顺序完全一致
- ✅ 翻译内容语义正确
- ✅ 保持上下文的延续关系
- ✅ 没有"翻译数量不匹配"的错误

## 如果测试失败

1. 查看控制台中的完整 API 响应
2. 分析 AI 的实际输出模式
3. 根据错误类型调整提示词：
   - 如果仍然合并序号 → 加强"格式化输出任务"的强调
   - 如果跳过序号 → 加强验证步骤的要求
   - 如果添加多余序号 → 明确只翻译指定的序号
4. 考虑使用更强的模型或其他策略

